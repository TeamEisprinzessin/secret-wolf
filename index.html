<html>
<head>
  <meta charset="utf-8">
  <title>Dokumentation</title>
  <meta name="descritpion" content="Dokumentation für secretwolf">

  <link rel="stylesheet" type="text/css" href="documentation/style.css" media="screen">
   <link href="https://fonts.googleapis.com/css?family=Muli|Open+Sans|Ubuntu+Mono" rel="stylesheet">
</head>
<body>
  <div class="content">
<img src="documentation/guenther.png" style="float: right; height: 160px;">
    <h1>Secret-Wolf</h1>

    <h4>Ein Schulprojekt von Florian und Fabian</h4>
    <h2 id="Einleitung">Einleitung</h2>
    <p>Das Projekt Secret-Wolf ist ein Browser-basiertes Spiel, welches innerhalb des Informatikunterrichts entstanden ist. Es basiert auf dem bereits vorhandenen Gesellschaftsspiel <a href="http://secrethitler.com/">Secret Hitler</a>, in welchem es um den Gewinn durch die Faschisten bzw. der Liberalen geht. Quelle ist das originale Secret Hitler, ein physisches Gesellschaftsspiel, das von Max Temkin <a href="https://www.kickstarter.com/projects/maxtemkin/secret-hitler">auf Kickstarter</a> erstellt wurde. Es wurde unter Creative Commons Lizenz (CC SA-BY-NC 4.0) zur nicht kommerziellen Verarbeitung unter Namensnennung des Urhebers freigegeben und bietet somit die Grundlage des <a href="#Konzept">Konzeptes</a> unseres Projekts.</p>
    <p>Das eigentliche Spiel ist bisher nur in Ansätzen vorhanden, unser Projekt fokussiert sich vorerst nur auf die Anmeldung und Rollenverteilung, also die erste Phase des Spiels. Theoretisch könnten wir von hier aus ein anderes Gesellschaftsspiel für unser Projekt wählen, daher haben wir "Secret Hitler" noch nicht direkt in unseren Projektnamen eingebaut. (Eine Alternative wäre z.B. das Spiel "Werwolf" gewesen.)</p>
    <p>Zur Umsetzung haben wir Code in PHP/HTML geschrieben, die Daten werden in einer MySQL-Datenbank gespeichert. Für spezielle Funktionen haben wir auch javascript verwendet.
    </p>
    <h2>Struktur und Aufbau</h2>
    <p class="code">
    <img src="documentation/diagramm.png"></p>
    <!-- Used for Conversion of html code to text: http://www.unit-conversion.info/texttools/text-to-html/#data -->
    <p class="code">&lt;html&gt;<br />&lt;head&gt;<br />&nbsp; &lt;meta charset="utf-8"&gt;<br />&nbsp; &lt;title&gt;Dokumentation&lt;/title&gt;<br />&nbsp; &lt;meta name="descritpion" content="Dokumentation f&uuml;r secretwolf"&gt;<br /><br />&nbsp; &lt;link rel="stylesheet" type="text/css" href="style.css" media="screen"&gt;<br />&nbsp;&nbsp; &lt;link href="https://fonts.googleapis.com/css?family=Muli|Open+Sans|Ubuntu+Mono" rel="stylesheet"&gt; <br />&lt;/head&gt;<br />&lt;body&gt;<br />&nbsp; &lt;div class="content"&gt;<br />&nbsp;&nbsp;&nbsp; &lt;h1&gt;Caption&lt;/h1&gt;<br />&nbsp;&nbsp;&nbsp; &lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;<br />&nbsp;&nbsp;&nbsp; &lt;p&gt;Hello World, this is a text.&lt;/p&gt;<br /><br />&nbsp;&nbsp;&nbsp; &lt;p class="code"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aasdf<br />&nbsp;&nbsp;&nbsp; &lt;/p&gt;<br />&nbsp; &lt;/div&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br /></p>
    <h2 id="Konzept">Erklärung des Konzepts</h2>
    <p>Bei der Programmierung unseres Projektes sind auf verschiedene Art und Weise Probleme aufgetaucht, welchen wir uns gestellt und diese schließlich gelöst haben. Im Folgenden werden einige dieser Probleme mit Hilfe von den Quellcodes aus unserem Projekt erklärt, so dass diese leichter verständlich sind. </p>
    <h2 id="Anmeldung">Benutzeranmeldung</h2>
    <h3 id="ErstellenAnmeldung">1. Erstellen einer Benutzeranmeldeseite</h3>
    <p>Für unser Spiel benötigen wir eine Benutzeranmeldung, wo sich jeder einzelne Spieler mit seinem Namen anmelden kann. Dies geschieht in einem HTML-Dokument, in welchem wir das Dokument zuerst in einen Wrapper-, Header- und Contentbereich unterteilt haben. Der Header beinhaltet den Titel unseres Spiels "Secret Wolf". Im Content-Bereich sind die nötigen Anmeldeinformationen wie der Sessionname, der Sitzplatz und der Name des Spielers verankert. Hierbei erstellen wir mit Hilfe des input-Elements Textfelder hinter den für uns wichtigen Informationen. In diesen Textfeldern kann der Spieler nun für die Session und für den Namen einen beliebigen Text eingeben. Für den Sitzplatz haben wirs ein Eingabefeld mit Hilfe von <em>type="number"</em> (für ein normales Textfeld steht im input-Element <em>type="text"</em>) ausschließlich auf Nummern beschränkt. Zuletzt bietet ein Bestätigungsbutton, welcher ebenfalls durch ein input-Element erstellt wurde, die Möglichkeit die Informationen abzuschicken und zur nächsten Seite zu gelangen. Der Unterschied bei diesem input-Element ist, dass der type auf <em>"submit"</em> gesetzt wurde. <em>"submit"</em> bedeutet, dass der Nutzer zur nächsten Seite weitergeleitet wird und die Inhalte des Formulars als Variablen für die nächste Seite verfügbar sind. <em>"value"</em> innerhalb des Befehls gibt die Bezeichnung des Buttons auf der HTML-Seite.</p>
    <p class="code">&lt;body&gt;<br />&nbsp;&nbsp; &nbsp;&lt;div class="wrapper"&gt;<br /><br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;div class="header"&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;p class="caption"&gt;Secret Wolf&lt;/p&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/div&gt;<br /><br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;div class="content"&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;form action="connect.php" method="post"&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;p&gt;Session: &lt;input type="text" name="session"/&gt;&lt;/p&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;p&gt;Seat: &lt;input type="number" name="seat" /&gt;&lt;/p&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;p&gt;Name: &lt;input type="text" name="name" /&gt;&lt;/p&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;p&gt; &lt;input type="submit" class="inputbutton" value="Best&auml;tigen"/&gt;&lt;/p&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/form&gt;<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&lt;/div&gt;<br /><br />&nbsp;&nbsp; &nbsp;&lt;/div&gt;<br />&lt;/body&gt;</p>
    <h3 id="AuslesenAnmeldung">2. Auslesen der Benutzereingaben</h3>
    <p>Per <em>"$_POST[]"</em>-Befehl werden auf der nächsten Seite (connect.php) die Eingaben aus der Form ausgelesen und in klassische Variablen geschrieben.</p>
    <p class="code">$session = $_POST['session'];<br />$seat = $_POST['seat'];<br />$name = $_POST['name'];</p>
    <h2 id="MySQL">MySQL</h2>
    <p>MySQL ist ein Programm zur Verwaltung von Datenbanken, mit denen man Daten/Informationen im Internet verarbeiten und verwalten kann. Es wird nicht grundsätzlich über eine grafische Oberfläche, sondern durch die Datenbanksprache SQL angesprochen. Die Daten werden intern so gespeichert, dass möglichst wenig Speicherplatz benötigt wird.</p>
    <h3 id="VerbindungMySQL">1. Verbindung mit der MySQL-Datenbank herstellen</h3>
    <p>Die Verbindung mit der MySQL-Datenbank steht am Anfang des Dokuments und wird mit Hilfe des Befehls "mysqli_connect" hergestellt. Hierbei benötigt der Befehl den Servernamen, den Benutzernamen, Kennwort und die gewünschte Datenbank. In unserem Fall haben wir diese Daten durch Variablen definiert, da wir im späteren Verlauf die Datenbank durch die Datenbankverbindung ansprechen möchten. Außerdem ist es sinnvoll nach der Verbindung mit der MySQL-Datenbank zu überprüfen, ob die Verbindung erfolgreich hergestellt wurde. Dies lässt sich mit Hilfe von einem if-Befehl mit folgender Ausgabe einer Fehlermeldung wie beispielsweise "Connection failed" bewirken.  </p>
    <p class="code">$mysqli = new mysqli($servername, $username, $password, $dbname);<br /><br />if (mysqli_connect_errno()) {<br />&nbsp;&nbsp; &nbsp;die("Connection failed: " . mysqli_connect_error());<br />}</p>
    <h3 id="ErstellenTabelle">2. Erstellen von Tabellen </h3>
    <p>Nachdem die MySQL-Verbindung hergestellt wurde, möchten wir in die Datenbank schreiben. Dafür benötigen wir eine Tabelle mit den Informationen der Spieler, welche sich mit dem Spiel verbinden möchten. Diese Tabelle erstellen wir mit Hilfe des folgenenden Befehls:</p>
    <p class="code">$sql = "CREATE TABLE $session (<br />&nbsp;&nbsp; &nbsp;id INT(6) UNSIGNED AUTO_INCREMENT PRIMARY KEY,<br />&nbsp;&nbsp; &nbsp;name VARCHAR(30) NOT NULL,<br />&nbsp;&nbsp; &nbsp;seat INT(6),<br />&nbsp;&nbsp; &nbsp;reg_date TIMESTAMP,<br />&nbsp;&nbsp; &nbsp;identity INT(6)<br />)";</p>
<p class="code"><br />if ($mysqli-&gt;query($sql) === TRUE) {<br />&nbsp;&nbsp; &nbsp;echo "Session " . $session . " successfully created.";<br />} else {<br />&nbsp;&nbsp; &nbsp;//die("Error creating Session (table): " . $conn-&gt;error);<br />&nbsp;&nbsp; &nbsp;echo "Session " . $session . " succesfully joined.";<br />}</p><p>Im PHP-Dokument werden MySQL-Befehle in Form einer Variable erst definiert und danach ausgeführt, wobei dies mit einer if-Klausel überprüft wird. Der Inhalt dieser Variable entspricht der SQL-Syntax, mit der man auch z.B. über die Kommandozeile mit MySQL interagieren kann; Der Befehl wird erst bei der Überprüfung mit dem Statement <em>"$mysqli->query($sql) === TRUE"</em> ausgeführt.</p>
    <p>Bei diesem Befehl erstellen wir eine Tabelle für die Session, welche der Benutzer in der Benutzeranmeldung eingegeben hatte. Diese Tabelle hat 5 Spalten. Die erste Spalte lautet <em>"id"</em> und nummeriert automatisch jeden folgenden Eintrag in der Tabelle. Weiterhin wird eine Spalte für den Spieler-Namen erstellt, in unserem Falle darf dieser Name nicht mehr als 30 Zeichen <em>("VARCHOR(30))"</em> beinhalten. Zusätzlich je eine Spalte für Sitzplatz und Identität, wobei diese beiden Spalten ausschließlich mit Zahlen befüllt werden <em>("INT(6)")</em>. Was es genau mit der Identität auf sich hat, gehen wir in der <a href="#Rollenverteilung">Rollenverteilung</a> ein. </p>
    <h3 id="BeschreibenTabelle">3. Beschreiben der Tabellen </h3>
    <p>Die Variablen "name", "seat" und "identity" (die anderen Einträge werden automatisch generiert) werden per folgendem Befehl in die Datenbank geschrieben.</p>
    <p class="code">if ($stmt = $mysqli-&gt;prepare("INSERT INTO $session (name, seat, identity) VALUES (?, ?, 0)")) {<br />&nbsp;&nbsp; &nbsp;/* Bind the variables to the parameter as strings */<br />&nbsp;&nbsp; &nbsp;$stmt-&gt;bind_param("ss", $name, $seat);<br />&nbsp;&nbsp; &nbsp;$stmt-&gt;execute();<br />&nbsp;&nbsp; &nbsp;$stmt-&gt;close();<br />}</p>
    <p>Wieder ist der eigentliche SQL-Befehl in einem String verpackt, für die Identität wird der Wert 0 eingesetzt, für Namen und Sitzplatz werden die php-Variablen <em>$name</em> und <em>$seat</em> in den Befehl eingebaut.
    <h3 id="Auslesung">4. Auslesen von Einträgen</h3>
    <p>Bisher wird einzig die Anzahl der Einträge für die Rollenverteilung aus der Datenbank ausgelesen. Hierfür fürd die gesamte Tabelle abgefragt <em>("SELECT *")</em>, und anschließend die Anzahl der Reihen gezählt.</p>
    <p class="code">$sql = $mysqli-&gt;prepare("SELECT * FROM $session");<br />$sql-&gt;execute();<br />$sql-&gt;store_result();<br /><br />$total = $sql-&gt;num_rows;</p>
    <h3 id="Rollenverteilung">5. Rollenverteilung</h3>
    <p>Die Rollenverteilung wird vom Dokument destiny.php ausgeführt. Zuerst werden die Einträge in der My-SQL-Tabelle gezählt und als gesamte Anzahl von Spielers festgehalten. Sind zum Beispiel 6 Einträge in der Tabelle vorhanden, wird die gesamte Anzahl an Spielern auf 6 gesetzt. Anschließend wird ausgewählt wie viele Identitäten gebraucht werden. In unserem Beispiel wären es 6 Identitäten, so dass die Identitäten 0,0,0,0,1,2 ausgewählt werden. Diese Zahlen werden in ein Array, also eine Sammlung von Variablen geschrieben (<em>"$identities"</em>). Das Spiel ist nur mit minimal 5 und maximal 10 Spielern spielbar, weshalb die Verbindung bei weniger oder mehr Spielern unterbrochen wird und eine Fehlermeldung durch den Befehl <em>echo</em> auf dem Bildschirm des Spielers sichtbar ist. Die Identitäten werden mit Hilfe des Befehls <em>shuffle($identities)</em> gemischt und im folgenden Schritt an jeden einzelnen Spieler verteilt.</p>
    <p class="code">$total = $sql-&gt;num_rows;<br /><br /><br />// Possible identities: 0 = liberal; 1 = fascist; 2 = Hitler<br /><br />if ($total == 5){<br />&nbsp;&nbsp; &nbsp;$identities = [0,0,0,1,2];<br />} elseif ($total == 6){<br />&nbsp;&nbsp; &nbsp;$identities = [0,0,0,0,1,2];<br />} elseif ($total == 7){<br />&nbsp;&nbsp; &nbsp;$identities = [0,0,0,0,1,1,2];<br />} elseif ($total == 8){<br />&nbsp;&nbsp; &nbsp;$identities = [0,0,0,0,0,1,1,2];<br />} elseif ($total == 9){<br />&nbsp;&nbsp; &nbsp;$identities = [0,0,0,0,0,1,1,1,2];<br />} elseif ($total == 10){<br />&nbsp;&nbsp; &nbsp;$identities = [0,0,0,0,0,0,1,1,1,2];<br />} else {<br />&nbsp;&nbsp; &nbsp;echo("This game shall only be played amongst a gathering of five to ten participants. Ple4se ch3ck ur numb0r5 m8");<br />}<br />shuffle($identities);<br /><br />// Allocate identities to players<br />for ($i = 1; $i &lt;= $total; $i++) {<br />&nbsp;&nbsp; &nbsp;$ii = $i - 1;<br />&nbsp;&nbsp; &nbsp;$currentrole = $identities[$ii];<br />&nbsp;&nbsp; <br />&nbsp;&nbsp; &nbsp;$sql = "UPDATE $session SET identity=$currentrole WHERE id=$i";<br />&nbsp;&nbsp; &nbsp;if(mysqli_query($mysqli, $sql)){<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;echo "Player " . $i . ": Success!&lt;br&gt;";<br />&nbsp;&nbsp; &nbsp;} else {<br />&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;echo "Player " . $i . ": Failure :(&lt;br&gt;";<br />&nbsp;&nbsp; &nbsp;}<br />}</p>
    <p>Die Verteilung der Identitäten an die Spieler läuft schrittweise über eine Schleife, in der pro Durchgang eine Variable von 1 aus hochzählt, sobald sie die maximale Spieleranzahl erreicht hat, wird die Schleife nicht mehr ausgeführt. Mit dieser Schrittzahl wird gleichzeitig der zu beschreibende Eintrag festgelegt, sodass die Tabelle von oben nach unten durchgearbeitet wird. Es wird jeweils die erste, zweite, dritte, etc. Variable aus dem Array <em>$identities</em> verwendet.</p>
    <h2 id="Cookies">Cookies</h2>
    <p>Cookies sind Datensätze, die von einem Webserver auf dem Computer des Benutzers abgelegt werden. Sie werden bei einer erneuten Verbindung an den Webserver mit dem Ziel zurückgesedet, den Nutzer und seine Einstellungen wiederzuerkennen. Hier werden Daten wie Name und Session gespeichert, damit der Server dem Nutzer die richtigen Informationen senden kann.</p>
    <h3 id="ErstellenCookies">1. Erstellen von Cookies</h3>
    <p>Der Befehl, in PHP einen Cookie zu erstellen, ist denkbar einfach:</p>
    <p class="code">setcookie("session", $session, time()+86400);</p>
    <p>Der erste Wert benennt den Cookie, der zweite beschreibt seinen Inhalt, der Dritte gibt an, wie lange er in Sekunden existieren soll.</p>
    <h3 id="AuslesenCookies">2. Auslesen von Cookies</h3>
    <p>Das Auslesen funktioniert ebenso simpel, der Wert wird hier in eine Variable geschrieben.</p>
    <p class="code">$session = $_COOKIE['session'];</p>
    <h2 id="Chat">Einbindung eines Chats</h2>
    <p> </p>
    <h2 id="CSS">CSS (Cascading Style Sheets)</h2>
    <p>CSS ist eine Stilsprache, die das Aussehn von HTML-Dokumenten definiert. Zum Beispiel kann CSS zum Festlegen von Schriftarten, Farben, Hintergrundbildern und Positionierungen verwendet werden. Der Unterschied zwischen HTML und CSS ist, dass HTML den Inhalt strukturiert und CSS den strukturierten Inhalt formatiert, dies bedeutet, dass der Schriftstil des Inhalts geändert wird. </p>
    <h3 id="Schriftarten">1. Hinzufügen von Schriftarten</h3>
    <p> </p>
    <h3 id="Stil">2. Stil der Schrift ändern</h3>
    <p> </p>
      
    
    
  </div>
</body>
</html>
